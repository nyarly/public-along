Offboarding Worker Request
====================================

Name: <%= @employee.cn %>

Termination Date: <%= @employee.termination_date.strftime("%b %e, %Y") %>

EmployeeID: <%= @employee.employee_id %>

Title: <%= @employee.job_title.try(:name) %>

Department: <%= @employee.department.name %>

Location: <%= @employee.location.name %>

Manager: <%= @employee.manager.try(:cn) %>

Manager Email: <%= @employee.manager.email %>

Offboard Info:
--------------

Archive Data: <%= @info.archive_data %>

Forward Email To: <%= @info.forward_email %>

Reassign Salesforce Cases To: <%= @info.reassign_salesforce %>

Transfer Google Docs To: <%= @info.forward_google %>

Active Security Profile Termination Instructions:
-------------------------------------------------

<% @employee.active_security_profiles.each do |sp| %>
<%= sp.name %>:

<% sp.access_levels.find_each do |al| %>
<%= al.name %> <%= al.application.name %>

<% if Application::AUTOMATED_OFFBOARDS.include? al.application.name %>
- Account will be deactivated by Mezzo.
<% end %>
<% if al.application.ad_controls? %>
- Worker will automatically be removed from the related Active Directory group in 7 days. No further action needed.
<% end %>
<% if al.application.dependency.present? %>
- <%= al.application.dependency %>
<% end %>
<% if al.application.offboard_instructions.present? %>
- <%= al.application.offboard_instructions %>
<% end %>

<% if al.application.name.include? "Office 365" %>
<%= render partial: "offboard_office", locals: {employee: @employee, info: @info} %>
<% end %>
<% end %>
<% end %>
<% if @employee.offboarding_infos.present? && @employee.offboarding_infos.emp_transaction.notes.present? %>
Additional Instructions from Manager
-------------------------------------------------

<%= @employee.offboarding_infos.emp_transaction.notes %>
<% end %>
