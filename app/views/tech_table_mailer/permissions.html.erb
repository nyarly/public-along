<div style="font-family: helvetica;">
  <h1><%= @emp_transaction.kind %> Request</h1>

  <p>
    <strong>Submission Date:</strong>
    <%= @emp_transaction.created_at.strftime("%b %e, %Y") %>
  </p>

  <p>
    <strong>Start Date:</strong>
    <%= @employee.hire_date.strftime("%b %e, %Y") %>
  </p>

  <% if @emp_transaction.kind == "Offboarding" %>
    <strong>Termination Date:</strong>
    <%= @employee.termination_date.strftime("%b %e, %Y") %>
  <% end %>

  <p>
    <strong>Name:</strong>
    <%= @employee.cn %>
  </p>

   <p>
    <strong>EmployeeID:</strong>
    <%= @employee.employee_id %>
  </p>

  <p>
    <strong>Title:</strong>
    <%= @employee.business_title %>
  </p>

  <p>
    <strong>Department:</strong>
    <%= @employee.department.name %>
   </p>

  <p>
    <strong>Location:</strong>
    <%= @employee.location.name %>
   </p>

  <p>
    <strong>Manager:</strong>
    <%= @manager.first_name %> <%= @manager.last_name %>
  </p>

  <p>
    <strong>Manager Email:</strong>
    <%= @manager.email %>
  </p>

  <% if @emp_transaction.kind == "Onboarding" && @employee.is_contingent_worker? %>
    <p>
      <strong>Contingent Worker:</strong>
      <div style="margin-left: 2em">
        <ul>
          <li style="color: <%= @emp_transaction.onboarding_infos.first.cw_email ? 'red' : 'limegreen' %>"><p>Create OpenTable Email: <%= @emp_transaction.onboarding_infos.first.cw_email %></p></li>
          <li style="color: <%= @emp_transaction.onboarding_infos.first.cw_google_membership ? 'red' : 'limegreen' %>"><p>Create Google Group Membership: <%= @emp_transaction.onboarding_infos.first.cw_google_membership %></p></li>
        </ul>
      </div>
    </p>
  <% end %>

  <% if @emp_transaction.kind == "Onboarding" || @emp_transaction.kind == "Security Access" %>
    <% if @emp_transaction.security_profiles.count > 0 %>
      <p>
        <strong>Apply Security Profiles:</strong>
      </p>
      <div style="margin-left: 2em">
        <% @emp_transaction.security_profiles.each do |sp| %>
          <div>
            <%= sp.name %><br>
            <ul>
              <% sp.access_levels.find_each do |al| %>
                <li style="margin-left: 2em"><%= al.name %> <%= al.application.name %></li>
                  <% if(al.application.dependency.present? || al.application.instructions.present?) %>
                    <p style="margin-left: 2em; color: red"><%= al.application.dependency %></p>
                    <p style="margin-left: 2em; color: red"><%= al.application.instructions %></p>
                  <% else %>
                    <p style="margin-left: 2em; color: limegreen">No further action needed.</p>
                  <% end %>
              <% end %>
            </ul>
          </div>
        <% end %>
      </div>
    <% end %>
    <% if @emp_transaction.revoked_security_profiles.count > 0 %>
      <p>
        <strong>Revoke Security Profiles:</strong>
      </p>
      <div style="margin-left: 2em">
        <% @emp_transaction.revoked_security_profiles.each do |sp| %>
          <div>
            <%= sp.name %><br>
            <ul>
              <% sp.access_levels.find_each do |al| %>
                <li style="margin-left: 2em"><%= al.name %> <%= al.application.name %></li>
                  <% if(al.application.dependency.present? || al.application.instructions.present?) %>
                    <p style="margin-left: 2em; color: red"><%= al.application.dependency %></p>
                    <p style="margin-left: 2em; color: red"><%= al.application.instructions %></p>
                  <% else %>
                    <p style="margin-left: 2em; color: limegreen">No further action needed.</p>
                  <% end %>
              <% end %>
            </ul>
          </div>
        <% end %>
      </div>
    <% end %>
  <% end %>

  <% if @emp_transaction.kind == "Onboarding" || @emp_transaction.kind == "Equipment" %>
    <p>
      <strong>Machine Bundle:</strong>
    </p>
    <div style="margin-left: 2em">
      <% @emp_transaction.machine_bundles.each do |mb| %>
        <div>
          <%= mb.name %><br>
          <ul>
            <li style="margin-left: 2em"><%= mb.description %></li>
          </ul>
        </div>
      <% end %>
    </div>
  <% end %>

  <% if @emp_transaction.kind == "Offboarding" %>
    <p>
      <strong>Archive Data:</strong>
      <span style="color: <%= @emp_transaction.offboarding_infos.first.archive_data ? 'red' : 'limegreen' %>"><%= @emp_transaction.offboarding_infos.first.archive_data %></span>
    </p>
    <p>
      <strong>Forward Email To:</strong>
      <span style="color: red"><%= Employee.find(@emp_transaction.offboarding_infos.first.forward_email_id).cn %></span>
    </p>
    <p>
      <strong>Reassign Salesforce Cases To:</strong>
      <span style="color: red"><%= Employee.find(@emp_transaction.offboarding_infos.first.reassign_salesforce_id).cn %></span>
    </p>
    <% unless @emp_transaction.offboarding_infos.first.transfer_google_docs_id.blank? %>
      <p>
        <strong>Transfer Google Docs To:</strong>
        <span style="color: red"><%= Employee.find(@emp_transaction.offboarding_infos.first.transfer_google_docs_id).cn %></span>
      </p>
    <% end %>
    <p>
      <strong>Active Security Profiles To Terminate:</strong>
    </p>
    <div style="margin-left: 2em">
        <% @employee.active_security_profiles.each do |sp| %>
          <div>
            <%= sp.name %><br>
            <ul>
              <% sp.access_levels.find_each do |al| %>
                <li style="margin-left: 2em"><%= al.name %> <%= al.application.name %></li>
                  <% if(al.application.dependency.present? || al.application.instructions.present?) %>
                    <p style="margin-left: 2em; color: red"><%= al.application.dependency %></p>
                    <p style="margin-left: 2em; color: red"><%= al.application.instructions %></p>
                  <% else %>
                    <p style="margin-left: 2em; color: limegreen">Worker will automatically be removed from the related Active Directory group in 30 days. No further action needed.</p>
                  <% end %>
              <% end %>
            </ul>
          </div>
        <% end %>
      </div>
  <% end %>

  <p>
    <strong>Additional Instructions:</strong>
    <span style="color:red"><%= @emp_transaction.notes %></span>
  </p>
</div>
