<h1>Employee Event Details</h1>

<p>
  <strong>Submission Date:</strong>
  <%= @emp_transaction.created_at.strftime("%b %e, %Y") %>
</p>

<p>
  <strong>Name:</strong>
  <%= link_to @employee.cn, employee_path(@employee) %>
</p>

<p>
  <strong>Title:</strong>
  <%= @employee.business_title %>
</p>

<p>
  <strong>Department:</strong>
  <%= @employee.department.name %>
 </p>

<p>
  <strong>Location:</strong>
  <%= @employee.location.name %>
</p>

<p>
  <strong>Manager:</strong>
  <%= @manager.first_name %> <%= @manager.last_name %>
</p>

<% if @emp_transaction.kind == "Onboarding" && !@employee.is_contingent_worker? %>
  <p>
    <strong>Buddy:</strong>
    <%= @buddy.first_name %> <%= @buddy.last_name %>
  </p>
<% end %>

<% if @emp_transaction.kind == "Onboarding" && @employee.is_contingent_worker? %>
  <p>
    <strong>Contingent Worker:</strong>
    <div class="indent-1">
      <ul>
        <li>Create OpenTable Email: <%= @emp_transaction.onboarding_infos.first.cw_email %></li>
        <li>Create Google Group Membership: <%= @emp_transaction.onboarding_infos.first.cw_google_membership %></li>
      </ul>
    </div>
  </p>
<% end %>

<% if (@emp_transaction.kind == "Onboarding" || @emp_transaction.kind == "Security Access") %>
  <% if @emp_transaction.security_profiles.count > 0 %>
    <p>
      <strong>Applied Security Profiles:</strong>
    </p>
    <div class="indent-1">
      <% @emp_transaction.security_profiles.each do |sp| %>
        <div>
          <%= sp.name %><br>
          <ul>
            <% sp.access_levels.find_each do |al| %>
              <li class="indent-1"><small><%= al.name %> <%= al.application.name %></small></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>
  <% end %>

  <% if @emp_transaction.revoked_security_profiles.count > 0 %>
    <p>
      <strong>Revoked Security Profiles:</strong>
    </p>
    <div class="indent-1">
      <% @emp_transaction.revoked_security_profiles.each do |sp| %>
        <div>
          <%= sp.name %><br>
          <ul>
            <% sp.access_levels.find_each do |al| %>
              <li class="indent-1"><small><%= al.name %> <%= al.application.name %></small></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>
  <% end %>

  <p>
    <strong>Active Security Profiles:</strong>
  </p>
  <div class="indent-1">
    <% @employee.active_security_profiles.each do |sp| %>
      <div>
        <%= sp.name %><br>
        <ul>
          <% sp.access_levels.find_each do |al| %>
            <li class="indent-1"><small><%= al.name %> <%= al.application.name %></small></li>
          <% end %>
        </ul>
      </div>
    <% end %>
  </div>
<% end %>

<% if @emp_transaction.kind == "Onboarding" || @emp_transaction.kind == "Equipment" %>
  <p>
    <strong>Machine Bundle:</strong>
  </p>
  <div class="indent-1">
    <% @emp_transaction.machine_bundles.each do |mb| %>
      <div>
        <%= mb.name %><br>
        <ul>
          <li class="indent-1"><small><%= mb.description %></small></li>
        </ul>
      </div>
    <% end %>
  </div>
<% end %>

<% if @emp_transaction.kind == "Offboarding" %>
  <p>
    <strong>Archive Data:</strong>
    <%= @emp_transaction.offboarding_infos.first.archive_data %>
  </p>

  <p>
    <strong>Replacement Hired:</strong>
    <%= @emp_transaction.offboarding_infos.first.replacement_hired %>
  </p>

  <p>
    <strong>Forward Email To:</strong>
    <%= Employee.find(@emp_transaction.offboarding_infos.first.forward_email_id).cn %>
  </p>

  <p>
    <strong>Reassign SalesForce Cases To:</strong>
    <%= Employee.find(@emp_transaction.offboarding_infos.first.reassign_salesforce_id).cn %>
  </p>

  <p>
    <strong>Transfer GoogleDocs To:</strong>
    <%= Employee.find(@emp_transaction.offboarding_infos.first.transfer_google_docs_id).try(:cn) %>
  </p>
<% end %>

<% unless @emp_transaction.notes.blank? %>
  <p>
    <strong>Additional Instructions:</strong>
    <%= @emp_transaction.notes %>
  </p>
<% end %>
